<div id="wp-custom-wrapper">
  <div id="header-container" class="total-header">
    <nav class="werewolf-nav">
      <ul class="nav-links">
        <li><a href="https://werewolf.ourflora.com/">Home</a></li>
        <li><a href="https://werewolf.ourflora.com/movies-anywhere/">Movies</a></li>
        <li class="dropdown">
          <a href="#">Crew â–¼</a>
          <div class="dropdown-content">
            <a href="https://werewolf.ourflora.com/werewolf/" class="link-werewolf">Werewolf3788</a>
            <a href="https://werewolf.ourflora.com/darkwing-dog/" class="link-tj">terrdog420</a>
            <a href="https://werewolf.ourflora.com/raymystro/" class="link-ray">Raymystyro</a>
            <a href="https://werewolf.ourflora.com/mjolnirgaming-2/" class="link-michael">MjolnirGaming</a>
          </div>
        </li>
        <li><a href="https://www.amazon.com/goldbox?tag=werewolf3788-20" target="_blank">Deals</a></li>
      </ul>
    </nav>
    <div id="game-status" class="status-bar">Syncing...</div>
  </div>
</div>

<style>
  :root {
    --werewolf-orange: #FE4B03; 
    --game-color: #333; 
    --fire-engine-red: #D70013;
    --police-blue: #2500E0;
  }

  body { margin: 0; background: #000; }
  
  /* CONTAINER: Responsive 95% Width */
  #wp-custom-wrapper { 
    width: 95% !important; 
    margin: 5px auto; 
    font-family: 'Segoe UI', Impact, sans-serif;
    box-sizing: border-box;
  }

  /* THE BOX: Now fits content tightly */
  .total-header {
    background: #000;
    border: 4px solid var(--game-color);
    border-radius: 8px;
    overflow: hidden;
    transition: border-color 0.5s ease;
    display: flex;
    flex-direction: column;
  }

  /* NAVIGATION: Reduced height to fit links tightly */
  .nav-links {
    list-style: none; 
    display: flex; 
    justify-content: center;
    align-items: center; 
    margin: 0; 
    padding: 5px 0; /* Reduced padding for tighter fit */
    flex-wrap: wrap;
  }

  .nav-links a {
    color: var(--werewolf-orange) !important;
    text-decoration: none; 
    font-weight: 900; 
    padding: 8px 12px; 
    text-transform: uppercase;
    font-size: 14px;
  }

  /* STATUS BAR: Compacted */
  .status-bar {
    background-color: var(--game-color);
    color: #fff;
    text-align: center;
    padding: 6px; /* Narrower mission bar */
    font-weight: 800;
    text-transform: uppercase;
    letter-spacing: 1px;
    font-size: 11px;
    transition: background-color 0.5s ease;
  }

  /* FIRE ENGINE SIREN */
  .siren-active {
    animation: sirenBorder 0.4s steps(1, end) infinite !important;
  }
  .siren-active .status-bar {
    animation: sirenBG 0.4s steps(1, end) infinite !important;
  }

  @keyframes sirenBorder {
    0%, 100% { border-color: var(--fire-engine-red) !important; }
    50% { border-color: var(--police-blue) !important; }
  }
  @keyframes sirenBG {
    0%, 100% { background-color: var(--fire-engine-red) !important; }
    50% { background-color: var(--police-blue) !important; }
  }

  /* DROPDOWN: Positioned exactly below the nav */
  .dropdown-content { 
    display: none; 
    position: absolute; 
    background: #000; 
    border: 2px solid var(--game-color); 
    min-width: 160px; 
    z-index: 99; 
  }
  .dropdown:hover .dropdown-content { display: block; }
  .dropdown-content a { display: block; padding: 10px; border-bottom: 1px solid #222; font-size: 12px; }

  /* TEAM COLORS */
  .link-werewolf { color: var(--werewolf-orange) !important; }
  .link-ray { color: #C41E3A !important; }
  .link-tj { color: #A020F0 !important; }
  .link-michael { color: #0000FF !important; }

  @media (max-width: 600px) {
    .nav-links a { font-size: 11px; padding: 5px 8px; }
    #wp-custom-wrapper { width: 98% !important; }
  }
</style>

<script>
  async function syncTwitch() {
    const header = document.getElementById('header-container');
    const status = document.getElementById('game-status');
    
    const gameColors = {
      "the angler": "#00CCFF",
      "call of the wild": "#355E3B",
      "red dead": "#BA0000",
      "world of tanks": "#545454",
      "jurassic park": "#4B3621",
      "need for speed": "SIREN",
      "default": "#444"
    };

    try {
      const resp = await fetch('https://decapi.me/twitch/game/werewolf3788?v=' + Date.now());
      const gameText = await resp.text();
      const gameLower = gameText.toLowerCase();

      header.classList.remove('siren-active');
      status.innerText = "MISSION: " + gameText;

      let activeColor = gameColors["default"];

      for (const [key, value] of Object.entries(gameColors)) {
        if (gameLower.includes(key)) {
          if (value === "SIREN") {
            header.classList.add('siren-active');
            return;
          } else {
            activeColor = value;
          }
          break;
        }
      }
      document.documentElement.style.setProperty('--game-color', activeColor);
    } catch (e) {
      status.innerText = "OFFLINE / API ERR";
    }
  }

  syncTwitch();
  setInterval(syncTwitch, 30000);
</script>
